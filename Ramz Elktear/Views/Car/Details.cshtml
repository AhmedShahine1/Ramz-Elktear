@model CarDTO
<div>
    <script>
        // Get language from localStorage (default to Arabic "ar" if not set)
        let selectedLang = localStorage.getItem("selectedLang") || "ar";

        // Update the URL with the selected language if not already set
        const urlParams = new URLSearchParams(window.location.search);
        if (!urlParams.has("lang") || urlParams.get("lang") !== selectedLang) {
            urlParams.set("lang", selectedLang);
            history.replaceState(null, "", "?" + urlParams.toString());
        }

        // Function to toggle language and reload the page
        function switchLanguage() {
            selectedLang = selectedLang === "ar" ? "en" : "ar"; // Toggle between Arabic and English
            localStorage.setItem("selectedLang", selectedLang); // Store in localStorage
            urlParams.set("lang", selectedLang);
            window.location.search = urlParams.toString(); // Reload with updated language
        }
    </script>
    @{
        string language = Context.Request.Query["lang"];
        if (string.IsNullOrEmpty(language))
        {
            language = "ar"; // Default to Arabic
        }
        var isArabic = language == "ar";
    }

    <section class="py-5">
        <div class="container">
            <div class="row gx-5">
                <aside class="col-lg-6">
                    <div class="border rounded-4 mb-3 d-flex justify-content-center">
                        <img id="mainImage" class="rounded-4 fit" style="max-width: 100%; max-height: 100vh;" src="@Model.ImageUrl" />
                    </div>
                    <div class="d-flex justify-content-center mb-3">
                        @foreach (var imageUrl in Model.ImagesUrl)
                        {
                            <a class="border mx-1 rounded-2">
                                <img width="60" height="60" class="rounded-2" src="@imageUrl" onclick="swapImage(this)" />
                            </a>
                        }
                    </div>
                </aside>
                <main class="col-lg-6">
                    <h4 class="title text-dark">@(isArabic ? Model.NameAr : Model.NameEn)</h4>
                    <p><strong>@(isArabic ? "كود السيارة" : "Car Code"):</strong> @Model.CarCode</p>
                    <p><strong>@(isArabic ? "رقم تعريف السيارة" : "Car SKU"):</strong> @Model.CarSKU</p>
                    <p><strong>@(isArabic ? "الفئة الفرعية" : "SubCategory"):</strong> @(isArabic ? Model.SubCategory?.NameAr : Model.SubCategory?.NameEn)</p>
                    <p><strong>@(isArabic ? "عدد الكيلومترات" : "Kilometers"):</strong> @Model.Kilometers</p>
                    <p><strong>@(isArabic ? "سعر التقسيط" : "Installment Price"):</strong> @Model.InstallmentPrice</p>
                    <p><strong>@(isArabic ? "سعر البيع" : "Selling Price"):</strong> @Model.SellingPrice</p>
                    <p><strong>@(isArabic ? "الحالة" : "Status"):</strong> @(Model.IsActive ? (isArabic ? "نشط" : "Active") : (isArabic ? "غير نشط" : "Inactive"))</p>
                    <p><strong>@(isArabic ? "مميز" : "Special"):</strong> @(Model.IsSpecial ? (isArabic ? "نعم" : "Yes") : (isArabic ? "لا" : "No"))</p>
                    <p>
                        <strong>@(isArabic ? "اللون" : "Color"):</strong>
                        @foreach (var color in Model.Color)
                        {
                            <span class="badge" style="background-color:@color.Value; width: 25px; height: 25px; display: inline-block; border-radius: 30px; border: 2px solid black;"></span>
                        }
                    </p>
                </main>
            </div>
        </div>
    </section>

    <section class="container mt-4">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#details">@(isArabic ? "التفاصيل" : "Details")</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#specifications">@(isArabic ? "المواصفات" : "Specifications")</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#offers">@(isArabic ? "العروض" : "Offers")</button>
            </li>
        </ul>
        <div class="tab-content mt-3">
            <div class="tab-pane fade" id="offers">
                <ul>
                    @foreach (var offer in Model.Offer)
                    {
                        <li>@(isArabic ? offer.NameAr : offer.NameEn)</li>
                    }
                </ul>
            </div>
            <div class="tab-pane fade" id="specifications">
                <ul>
                    @foreach (var specification in Model.Specifications)
                    {
                        <li>@(isArabic ? specification.NameAr : specification.NameEn)</li>
                    }
                </ul>
            </div>
            <div class="tab-pane fade show active" id="details">
                <ul>
                    <li><strong>@(isArabic ? "الوصف" : "Description"):</strong> @(isArabic ? Model.DescrptionAr : Model.DescrptionEn)</li>
                    <li><strong>@(isArabic ? "موديل السنة" : "Model Year"):</strong> @Model.ModelYear.Name</li>
                    <li><strong>@(isArabic ? "موضع المحرك" : "Engine Position"):</strong> @(isArabic ? Model.EnginePosition?.NameAr : Model.EnginePosition?.NameEn)</li>
                    <li><strong>@(isArabic ? "ناقل الحركة" : "Transmission Type"):</strong> @(isArabic ? Model.TransmissionType?.NameAr : Model.TransmissionType?.NameEn)</li>
                    <li><strong>@(isArabic ? "حجم المحرك" : "Engine Size"):</strong> @(isArabic ? Model.EngineSize?.NameAr : Model.EngineSize?.NameEn)</li>
                    <li><strong>@(isArabic ? "الخيار" : "Option"):</strong> @(isArabic ? Model.Option?.NameAr : Model.Option?.NameEn)</li>
                    <li><strong>@(isArabic ? "الأصل" : "Origin"):</strong> @(isArabic ? Model.Origin?.NameAr : Model.Origin?.NameEn)</li>
                </ul>
            </div>
        </div>
    </section>

    <div class="container text-center py-4">
        <a href="@Url.Action("Index")" class="btn btn-primary">@(isArabic ? "العودة إلى القائمة" : "Back to List")</a>
    </div>

    <script>
        function swapImage(img) {
            let mainImage = document.getElementById("mainImage");
            let tempSrc = mainImage.src;
            mainImage.src = img.src;
            img.src = tempSrc;
        }
    </script>

</div>
